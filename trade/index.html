<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binance Futures Setup Tool</title>
    <style>
        :root { --bg: #0b0e11; --card: #1e2329; --text: #eaecef; --primary: #fcd535; --long: #0ecb81; --short: #f6465d; --border: #474d57; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; padding: 20px; }
        .calc-card { background: var(--card); padding: 20px; border-radius: 12px; width: 100%; max-width: 400px; border: 1px solid #333; }
        h3 { color: var(--primary); text-align: center; margin-bottom: 20px; }
        .input-group { margin-bottom: 12px; }
        label { display: block; font-size: 0.8rem; color: #848e9c; margin-bottom: 4px; }
        input, select { width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: #2b3139; color: #fff; box-sizing: border-box; font-size: 1rem; }
        .btn-group { display: flex; gap: 10px; margin: 20px 0; }
        button { flex: 1; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-long { background: var(--long); color: #000; }
        .btn-short { background: var(--short); color: #fff; }
        .results { border-top: 1px solid #333; padding-top: 15px; display: none; }
        .res-item { display: flex; justify-content: space-between; margin-bottom: 8px; padding: 10px; background: #161a1e; border-radius: 6px; font-size: 0.9rem; }
        .val { font-weight: bold; }
        .up { color: var(--long); }
        .down { color: var(--short); }
        .liq { color: #f0b90b; border: 1px solid #f0b90b; }
    </style>
</head>
<body>

<div class="calc-card">
    <h3>Trade Setup</h3>
    
    <div class="input-group">
        <label>Investment Amount (Margin $)</label>
        <input type="number" id="margin" value="100">
    </div>

    <div class="input-group">
        <label>Leverage</label>
        <select id="leverage">
            <option value="20">20x</option>
            <option value="50" selected>50x</option>
            <option value="100">100x</option>
        </select>
    </div>

    <div class="input-group">
        <label>Entry Price ($)</label>
        <input type="number" id="entry" placeholder="Example: 65000">
    </div>

    <div style="display: flex; gap: 10px;">
        <div class="input-group" style="flex: 1;">
            <label>TP % (Target)</label>
            <input type="number" id="tp_pct" value="50">
        </div>
        <div class="input-group" style="flex: 1;">
            <label>SL % (Max Loss)</label>
            <input type="number" id="sl_pct" value="20">
        </div>
    </div>

    <div class="btn-group">
        <button class="btn-long" onclick="runCalc('long')">LONG (Buy)</button>
        <button class="btn-short" onclick="runCalc('short')">SHORT (Sell)</button>
    </div>

    <div class="results" id="results">
        <div class="res-item"><span>Position Size:</span> <span class="val" id="res-size"></span></div>
        <div class="res-item liq"><span>Est. Liquidation:</span> <span class="val" id="res-liq"></span></div>
        <div class="res-item"><span>Take Profit Price:</span> <span class="val up" id="res-tp-p"></span></div>
        <div class="res-item"><span>Stop Loss Price:</span> <span class="val down" id="res-sl-p"></span></div>
        <div class="res-item"><span>Net Profit at TP:</span> <span class="val up" id="res-tp-usd"></span></div>
        <div class="res-item"><span>Net Loss at SL:</span> <span class="val down" id="res-sl-usd"></span></div>
    </div>
</div>

<script>
function runCalc(side) {
    // 1. Get Inputs
    const m = parseFloat(document.getElementById('margin').value);
    const lev = parseInt(document.getElementById('leverage').value);
    const ent = parseFloat(document.getElementById('entry').value);
    const tp_p = parseFloat(document.getElementById('tp_pct').value) / 100;
    const sl_p = parseFloat(document.getElementById('sl_pct').value) / 100;

    // 2. Validation
    if (!ent || ent <= 0) { alert("Please enter a valid Entry Price"); return; }

    // 3. Math Constants
    const mmr = 0.004; // Maintenance Margin Rate (Binance Tier 1)
    const positionSize = m * lev;

    // 4. Core Calculations
    let liq, tpPrice, slPrice;

    if (side === 'long') {
        // LIQ = Entry * (1 - (1/Lev) + MMR)
        liq = ent * (1 - (1 / lev) + mmr);
        // TP = Entry * (1 + (Target%/Lev))
        tpPrice = ent * (1 + (tp_p / lev));
        // SL = Entry * (1 - (Stop%/Lev))
        slPrice = ent * (1 - (sl_p / lev));
    } else {
        // LIQ = Entry * (1 + (1/Lev) - MMR)
        liq = ent * (1 + (1 / lev) - mmr);
        // TP = Entry * (1 - (Target%/Lev))
        tpPrice = ent * (1 - (tp_p / lev));
        // SL = Entry * (1 + (Stop%/Lev))
        slPrice = ent * (1 + (sl_p / lev));
    }

    // 5. Update UI
    document.getElementById('res-size').innerText = "$" + positionSize.toFixed(2);
    document.getElementById('res-liq').innerText = "$" + liq.toFixed(2);
    document.getElementById('res-tp-p').innerText = "$" + tpPrice.toFixed(2);
    document.getElementById('res-sl-p').innerText = "$" + slPrice.toFixed(2);
    document.getElementById('res-tp-usd').innerText = "+$" + (m * tp_p).toFixed(2);
    document.getElementById('res-sl-usd').innerText = "-$" + (m * sl_p).toFixed(2);
    
    document.getElementById('results').style.display = 'block';
}
</script>

</body>
</html>
